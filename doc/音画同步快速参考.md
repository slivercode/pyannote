# 音画同步快速参考

## 🚀 快速诊断命令

### TTS生成后
```bash
python diagnose_tts_timeline.py output/updated_subtitles.srt --audio output/dubbing_result.wav
```

### 视频合并前
```bash
python verify_sync.py --video input/original_video.mp4 --audio output/dubbing_result.wav --subtitle output/updated_subtitles.srt
```

### 视频合并后
```bash
python verify_sync.py --video output/final_video.mp4 --subtitle output/final_subtitles.srt
```

---

## ✅ 正常输出示例

### TTS诊断正常
```
✅ 差异很小，基本匹配
音频 vs 字幕时间轴: 差异 +0.05秒 (50ms)
```

### 视频合并正常
```
✅ 时长差异可接受
视频 vs 字幕: 0.15秒差异
```

---

## ⚠️ 常见问题速查

| 问题 | 诊断输出 | 解决方案 |
|------|---------|---------|
| **间隙过大** | `⚠️ 间隙过大 (34.80秒)` | 关闭"保持SRT总时长"<br>启用"移除静音间隙" |
| **字幕被压缩** | `⚠️ 音频比字幕长 5.50秒` | 关闭"保持SRT总时长" |
| **字幕未调整** | `⚠️ 字幕比视频长，字幕时间轴可能未调整` | 重新合并视频 |
| **字幕重叠** | `⚠️ 字幕5和6存在重叠` | 重新生成TTS配音 |

---

## 🎯 推荐设置（跨语言配音）

```json
{
  "preserveTotalTime": false,  // ❌ 关闭
  "removeSilentGaps": true,    // ✅ 启用
  "silenceDuration": 0.5       // 0.5秒
}
```

---

## 📊 验证信息位置

### TTS生成日志
```
📊 字幕时间轴验证:
   字幕总数: 15
   字幕总时长: 85.50秒
   ✅ 未发现异常

📊 音频拼接验证:
   实际总时长: 120.25秒
   差异: 0.05秒
   ✅ 时长匹配良好
```

### 视频合并日志
```
📝 调整字幕时间轴: 拉伸 1.410x
✅ 字幕时间轴已调整:
   实际拉伸比: 1.410x (预期: 1.410x)
```

---

## 🔗 详细文档

- [音画同步验证工具使用指南](./音画同步验证工具使用指南.md)
- [音画同步问题诊断与解决方案](./音画同步问题诊断与解决方案.md)
- [音画同步改进总结](./音画同步改进总结.md)
