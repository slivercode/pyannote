# 首次启动说明

## 🎉 欢迎使用 TTS 配音系统！

### ✅ 首次启动自动配置

当你第一次启动项目时，系统会自动完成以下操作：

1. **检测配置文件**
   - 查找 `tts_config.json`（实际配置文件）
   - 如果不存在，继续下一步

2. **加载示例配置**
   - 读取 `tts_config.example.json`（示例配置）
   - 自动复制到 `tts_config.json`

3. **前端加载配置**
   - 浏览器自动加载配置
   - 显示预配置的角色

### 📋 示例配置内容

`tts_config.example.json` 包含：

- ✅ **GPT-SoVITS 配置**
  - API 地址: `http://192.168.110.204:9880`
  - 3 个示例角色（日文、中文、英文）

- ✅ **QwenTTS 配置**
  - 4 个预设音色

### 🚀 快速开始

**1. 启动服务**
```bash
python src/main.py
```

**2. 查看后端日志**
```
📋 首次启动，从示例配置加载: tts_config.example.json
✅ 已创建配置文件: tts_config.json
```

**3. 打开浏览器**
- 自动打开 `http://127.0.0.1:8514`
- 点击 **"TTS模型管理"**
- 查看已加载的示例角色

**4. 修改配置**
- 根据实际情况修改 API 地址
- 更新参考音频路径
- 添加或删除角色
- 点击 **"保存配置"**

### 📝 配置文件说明

#### `tts_config.example.json` (示例配置)
- 📌 **用途**: 提供配置模板
- 📌 **位置**: 项目根目录
- 📌 **修改**: 可以修改，但不影响实际使用
- 📌 **作用**: 仅在首次启动时使用

#### `tts_config.json` (实际配置)
- 📌 **用途**: 实际使用的配置
- 📌 **位置**: 项目根目录（自动生成）
- 📌 **修改**: 通过界面或手动编辑
- 📌 **作用**: 每次启动都会加载此文件

### 🔄 配置流程

```
首次启动
   ↓
检查 tts_config.json
   ↓
不存在 → 复制 tts_config.example.json
   ↓
创建 tts_config.json
   ↓
加载配置到前端
   ↓
用户修改配置
   ↓
保存到 tts_config.json
   ↓
后续启动直接加载 tts_config.json
```

### ⚙️ 自定义配置

如果你想使用自己的默认配置：

**方法1: 修改示例配置**
```bash
# 编辑示例配置文件
notepad tts_config.example.json

# 删除实际配置（让系统重新生成）
del tts_config.json

# 重启服务
python src/main.py
```

**方法2: 直接编辑实际配置**
```bash
# 编辑实际配置文件
notepad tts_config.json

# 重启服务或在界面点击"重新加载"
```

### 🎯 示例角色配置

#### 角色示例1（日文）
```json
{
  "name": "角色示例1",
  "refAudioPath": "cs3.mp3",
  "promptText": "何でだよ 私たちは治療を受けに来たんだよ そうだよ ここはお前の家じゃないだろ",
  "promptLang": "ja",
  "speedFactor": 1.0
}
```

#### 中文角色
```json
{
  "name": "中文角色",
  "refAudioPath": "chinese_voice.wav",
  "promptText": "你好，欢迎使用语音合成系统",
  "promptLang": "zh",
  "speedFactor": 1.0
}
```

#### 英文角色
```json
{
  "name": "英文角色",
  "refAudioPath": "english_voice.wav",
  "promptText": "Hello, welcome to the text to speech system",
  "promptLang": "en",
  "speedFactor": 1.0
}
```

### ⚠️ 注意事项

1. **参考音频文件**
   - 示例配置中的音频文件路径是示例
   - 需要根据实际情况修改
   - 确保文件在 GPT-SoVITS 服务器根目录

2. **API 地址**
   - 示例: `http://192.168.110.204:9880`
   - 根据实际部署地址修改

3. **首次使用**
   - 建议先测试示例角色
   - 确认配置正确后再添加自己的角色

### 🔍 验证配置加载

**浏览器控制台**（F12）:
```javascript
📥 加载TTS配置...
✅ TTS配置加载成功: {gptSovits: {...}, qwenTts: {...}}
📊 已加载 3 个 GPT-SoVITS 角色，4 个 QwenTTS 角色
```

**后端日志**:
```
📋 首次启动，从示例配置加载: d:\...\tts_config.example.json
✅ 已创建配置文件: d:\...\tts_config.json
```

### 📚 相关文档

- [TTS配置持久化说明.md](./TTS配置持久化说明.md) - 详细配置说明
- [TTS配置快速开始.md](./TTS配置快速开始.md) - 快速配置指南
- [TTS模型管理使用说明.md](./TTS模型管理使用说明.md) - 完整功能文档

### ✅ 检查清单

首次启动前确认：

- [ ] 已安装所有依赖（`pydub` 等）
- [ ] GPT-SoVITS 服务已部署
- [ ] 参考音频文件已准备
- [ ] 了解配置文件结构

首次启动后确认：

- [ ] `tts_config.json` 已自动创建
- [ ] 浏览器显示示例角色
- [ ] 可以打开 TTS 模型管理
- [ ] 配置可以正常保存

全部确认后，开始使用 TTS 配音功能！🎉

## 🆘 常见问题

### Q: 为什么没有自动加载示例配置？

**A**: 检查以下几点：
1. `tts_config.example.json` 是否存在
2. 文件格式是否正确（有效的 JSON）
3. 查看后端日志的错误信息

### Q: 如何重置为示例配置？

**A**: 删除 `tts_config.json`，重启服务即可：
```bash
del tts_config.json
python src/main.py
```

### Q: 示例配置中的角色无法使用？

**A**: 示例配置中的音频文件路径是示例，需要：
1. 准备实际的参考音频文件
2. 上传到 GPT-SoVITS 服务器
3. 修改配置中的路径
4. 保存配置

### Q: 配置保存后丢失？

**A**: 确认：
1. 点击了"保存配置"按钮
2. 看到成功提示
3. `tts_config.json` 文件已更新
4. 没有手动删除配置文件

---

现在你已经了解了首次启动的配置流程，开始使用吧！🚀
